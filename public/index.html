<!doctype html>
<html lang="en">
  <head>
    <title>CS4241 Assignment 2</title>
    <meta charset="utf-8">
  </head>
  <body>
    <form action="">
      <select type = "dropdown" id="parkingspot">
        <option value="spot1">spot 1</option>
        <option value="spot2">spot 2</option>
        <option value="spot3">spot 3</option>
        <option value="spot4">spot 4</option>
        <option value="spot5">spot 5</option>
        <option value="spot6">spot 6</option>
        <option value="spot7">spot 7</option>
        <option value="spot8">spot 8</option>
        <option value="spot9">spot 9</option>
      </select>
      <input type="text" id="licenseplate" value="license plate #">
      <select type = "dropdown" id="timelimit">
        <option value="add15">+ 15 min</option>
        <option value="add30">+ 30 min</option>
        <option value="add60">+ 60 min</option>
      </select>
      <button>submit</button>
    </form>
  </body>
  <script>

  const submit = function( e ) {
    // prevent default form action from being carried out
    e.preventDefault()

    // get all fields data from document
    const licensePlateInput = document.querySelector( '#licenseplate' )
    const parkingSpotInput = document.querySelector( '#parkingspot' )
    const timeInput = document.querySelector( '#timelimit' )
    const json = { parkingspot: parkingSpotInput.value,
                  licenseplate: licensePlateInput.value,
                  timelimit: timeInput.value
                 }
    const body = JSON.stringify( json )

    // send POST request to server
    fetch( '/submit', {
      method:'POST',
      body 
    })
    .then( function( response ) {
      // send GET request back to server
      console.log( response )
      
      fetch( '/data', {
        method:'GET'
      })
      .then( function( response ) {
        // update grid with body TODO 
        console.log( JSON.parse(response.body) )

        //json.parse(response.body)
      })
    })

    return false
  }

  window.onload = function() {
    const button = document.querySelector( 'button' )
    button.onclick = submit
  }

  </script>
</html>
